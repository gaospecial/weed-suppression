---
title: "Evaluating effectiveness of controlling little seed canary grass by using chemical herbicides and allelopathic integration"
author: "aminahadayat05@gmail.com"
date: "2023-02-21"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: no
      smooth_scroll: no
  md_document:
    variant: markdown_github
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  fig.width = 8,
  fig.asp=0.8,
  message = F,
  dpi = 300,
  collapse = TRUE,
  comment = "#>",
  fig.path = "figures/Figure-",
  fig.align = "center",
  out.width = "70%"
)
```

# Load packages

```{r packages}
library(tidyverse)
library(cowplot)
library(ggpubr)
library(pheatmap)
library(RColorBrewer)
library(vegan)
library(reshape2)
library(magrittr)
library(ggplot2)

theme_set(theme_bw())
```

To enable reproducible study, we provided the raw-data and source codes for analysis and generating figures.

# Data processsing

Raw data were stored in the `data` folder. It mainly comes from two experiments: one from growth room study, and the other is field experiment. The raw data is provided as in formatted form.

```{r}
weed_suppression <- read_csv("data/weed suppression.csv")
wheat_promotion <- read_csv("data/wheat promotion.csv")
weed_infestation <- read_csv("data/weed infestation.csv")
infested_wheat <- read_csv("data/infested wheat.csv")
head(weed_suppression) # suppress weed growth by herbicide and SynComs
head(wheat_promotion) # promote wheat growth by SynComs
head(weed_infestation) # 
head(infested_wheat)
```

The columns are:

-   `herbicide_dose`: herbicide_doses, indicating the name of two different chemical herbicides (Atlantis and Axial) at 25 and 50% of recommended doses: i.e. "Herbicide control", "Atlantis 25%", "Atlantis 50%", "Axial 25%", "Axial 50%".

-   `Inoculation`: Inoculation indicating the combinations of four different Pseudomonas strains (B11, T19, T24, T75) collected from Soil microbiology biochemistry laboratory, University of Agriculture Faisalabad. "C1", "C2", "C3", "C4" represent the Pseudomonas strain combinations such as C1 (B11 x T75), C2 (T19 x T24), C3 (B11 x T24 x T75) and C4 (B11 x T19 x T24 x T75).

-   `treatments`: Under field condition nine treatments were planned in block plot for both weed infestation and infested wheat with weedy and wheat free control respectively, in order to evaluate the selected C4 combination along with Axial herbicide at four different recommended doses such as: 25, 50, 75, and 100% Axial with respective control treatments.   

# Distribution of values

`weed_suppression` indicates the effect of SynComs and herbicides on the growth and physiology of *P. minor* under axenic condition. Nine parameters were obtained. 

```{r}
par(mfrow=c(3,3))

hist(weed_suppression$seed_germination, main = "Seed germination")
hist(weed_suppression$SPAD_value, main = "SPAD value")
hist(weed_suppression$plant_height, main = "Plant height")
hist(weed_suppression$root_length, main = "Root length")
hist(weed_suppression$fresh_biomass, main = "Fresh biomass")
hist(weed_suppression$protein, main = "Protein")
hist(weed_suppression$chlorophyll_a, main = "Chlorophyll A")
hist(weed_suppression$chlorophyll_b, main = "Chlorophyll B")
hist(weed_suppression$caroteniod, main = "Caroteniod")

```

# A new graph

Disign a graph to show the results more clearly. This plot has three parts. 

1. boxplot shows the value of data, and statistical results of comparision;
2. a dotplot shows the dose of herbicide;
3. another dotplot shows the applying inoculation.

* **seed germination rate of weed**

The less of seed germination rate of weed, the better of the suppression of a recipe.

```{r}
df = weed_suppression %>% 
  mutate(herbicide_dose = fct_rev(as_factor(herbicide_dose)),
         Inoculation = fct_rev(as_factor(Inoculation))) %>% 
  group_by(herbicide_dose, Inoculation) %>% 
  mutate(group = factor(cur_group_id()), .before = 3)

df$group = fct_reorder(df$group, df$seed_germination)

# find the group id by groups
groups = distinct(df, herbicide_dose, Inoculation, group) %>% 
  filter(herbicide_dose == "Herbicide control", Inoculation == "Control") 
ref_group = groups$group %>% as.character()

# boxplot
p1 = df %>% 
  ggplot(aes(group, seed_germination)) +
  geom_boxplot(outlier.shape = NA) +
  stat_compare_means(ref.group = ref_group,
                     method = "t.test",
                     hide.ns = TRUE,
                     label = "p.signif") +
  # geom_jitter(width = 0.01) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank())

# the herbicide dose
p2 = df %>% 
  ggplot(aes(group, herbicide_dose)) +
  geom_point(size = 3, shape = 15) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"))

# the inoculation
p3 = df %>% 
  ggplot(aes(group, Inoculation)) +
  geom_point(size = 3, shape = 15) +
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"))
aplot::plot_list(p1,p2,p3, ncol = 1, heights = c(1,.2,.2))
```

Control is located on the most right side, so that all the combinations of herbicide and SynComs have better effect in suppressing weed seed germination. Among them, who have the best performance are Axial 25%-50% plus C1/C3/C4.  

Now, every parameter can generate a similar plot.

```{r}
# reuse code with a function
plot_recipe_effect = function(df, value){
  df$group = fct_reorder(df$group, df[[value]])

  # find the group id by groups
  groups = distinct(df, herbicide_dose, Inoculation, group) %>% 
    filter(herbicide_dose == "Herbicide control", Inoculation == "Control") 
  ref_group = groups$group %>% as.character()
  
  p1 = df %>% 
    ggplot(aes_string("group", value)) +
    geom_boxplot(outlier.shape = NA) +
    stat_compare_means(ref.group = ref_group,
                       method = "t.test",
                       hide.ns = TRUE,
                       label = "p.signif") +
    # geom_jitter(width = 0.01) +
    theme(axis.title.x = element_blank(),
          axis.text.x = element_blank(),
          axis.ticks.x = element_blank())
  
  p2 = df %>% 
    ggplot(aes(group, herbicide_dose)) +
    geom_point(size = 3, shape = 15) +
    theme(axis.title.x = element_blank(),
          axis.text.x = element_blank(),
          axis.ticks.x = element_blank(),
          plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"))
  p3 = df %>% 
    ggplot(aes(group, Inoculation)) +
    geom_point(size = 3, shape = 15) +
    theme(axis.text.x = element_blank(),
          axis.ticks.x = element_blank(),
          plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "pt"))

  # combined graph
  aplot::plot_list(p1,p2,p3, ncol = 1, heights = c(1,.2,.2))
}
```


# Weed pigments

Plants contain several different pigments, including chlorophylls, carotenoids, and flavonoids. Chlorophylls are the primary pigments responsible for the green color of plants and are essential for photosynthesis. Carotenoids, which include beta-carotene, lycopene, lutein, and zeaxanthin, are responsible for the yellow, orange, and red colors of many fruits and vegetables, and also serve as antioxidants. Flavonoids, which include anthocyanins, flavonols, and flavones, are responsible for the red, blue, and purple colors of many fruits and flowers, and also play a role in plant defense against environmental stresses.

## SPAD value of weed

SPAD value is a measure provided by the SPAD-502Plus, which is a portable, non-destructive measuring device for the chlorophyll content of leaves.

```{r include=FALSE, fig.cap="Product of SPAD-502+"}
knitr::include_graphics("https://vnote-1251564393.cos.ap-chengdu.myqcloud.com/20230326110719.png")
```


```{r}
plot_recipe_effect(df, value = "SPAD_value")
```

## Chlorophyll A

There are several types of chlorophyll, including chlorophyll a, chlorophyll b, chlorophyll c, chlorophyll d, and chlorophyll e, each with their own unique molecular structure and light absorption properties. Chlorophyll is responsible for giving plants their green color, and it is also used as a natural food coloring agent and in some medicinal and industrial applications.

Chlorophyll a is the primary pigment involved in photosynthesis and is found in all photosynthetic organisms, including plants, algae, and cyanobacteria. It absorbs light most efficiently at wavelengths of 430-660 nm (blue and red light), and it plays a critical role in the initial stages of photosynthesis by absorbing light and passing on the energy to other molecules.

```{r}
plot_recipe_effect(df, value = "chlorophyll_a")
```


## Chlorophll B

Chlorophyll b, on the other hand, is an accessory pigment that is found only in higher plants and green algae. It absorbs light most efficiently at wavelengths of 450-650 nm (blue and orange light) and transfers this energy to chlorophyll a. Chlorophyll b also helps to broaden the spectrum of light that can be absorbed by the plant, allowing it to capture more energy from the sun and carry out photosynthesis more efficiently.

```{r}
plot_recipe_effect(df, value = "chlorophyll_b")
```

## Caroteniod

Carotenoids are a group of natural pigments that are found in many plants, algae, and some bacteria. They are responsible for the yellow, orange, and red colors of many fruits and vegetables, as well as the bright colors of many flowers. Carotenoids are important antioxidants that help protect plants and other organisms from damage caused by harmful molecules known as free radicals. In addition to their role in providing color to plants and other organisms, carotenoids also have important health benefits for humans, including promoting eye health, supporting the immune system, and reducing the risk of certain chronic diseases. Some common carotenoids include beta-carotene, lycopene, lutein, and zeaxanthin.


```{r}
plot_recipe_effect(df, value = "caroteniod")
```

# Weed growth

## Seed germination

```{r}
plot_recipe_effect(df, value = "seed_germination")
```

## Plant height

```{r}
plot_recipe_effect(df, value = "plant_height")
```

## Root length

```{r}
plot_recipe_effect(df, value = "root_length")
```

## Fresh biomass

```{r}
plot_recipe_effect(df, value = "fresh_biomass")
```

## Protein content

```{r}
plot_recipe_effect(df, value = "protein")
```


# Figure 1: Influence of AB combinations and chemical herbicides on *P. minor* growth and phenological parameter reduction in growth room trial {fig-1}

```{r}
# Germination %
germination_percentage <- weed_suppression %>% 
  select("herbicide_dose","Inoculation","seed_germination")
compare_means(seed_germination ~ Inoculation,
              data = germination_percentage,
              method = "t.test",
              group.by = "herbicide_dose")

# boxplot facet by "herbicide dose"
p1<-ggboxplot(germination_percentage,x="Inoculation",y="seed_germination",
             add = "jitter",
             facet.by = "herbicide_dose",short.panel.labs = FALSE)+
             labs(y="seed_germination (%)",x="Inoculation")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif",method = "t.test", ref.group = ".all.")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "top")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
p1
ggsave("figure 1.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

##SPAD
SPAD<-weed_suppression%>%select("herbicide_dose","Inoculation","SPAD_value")
compare_means(SPAD_value~Inoculation,data = SPAD,method = "t.test",group.by = "herbicide_dose")

#boxplot facet by "herbicide dose"
p2<-ggboxplot(SPAD,x="Inoculation",y="SPAD_value",
             add = "jitter",
             facet.by = "herbicide_dose",short.panel.labs = FALSE)+
             labs(y="SPAD_value",x="Inoculation")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif",method = "t.test", ref.group = ".all.")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "top")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
p2
ggsave("figure 1.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

###Plant height
PH<-weed_suppression%>%select("herbicide_dose","Inoculation","plant_height")
compare_means(plant_height~Inoculation,data = PH,method = "t.test",group.by = "herbicide_dose")

#boxplot facet by "herbicide dose"
p3<-ggboxplot(PH,x="Inoculation",y="plant_height",
             add = "jitter",
             facet.by = "herbicide_dose",short.panel.labs = FALSE)+
             labs(y="plant_height (cm)",x="Inoculation")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif",method = "t.test", ref.group = ".all.")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "top")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
p3
ggsave("figure 1.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

#####Root length
RL<-weed_suppression%>%select("herbicide_dose","Inoculation","root_length")
compare_means(root_length~Inoculation,data = RL,method = "t.test",group.by = "herbicide_dose")

#boxplot facet by "herbicide dose"
p4<-ggboxplot(RL,x="Inoculation",y="root_length",
             add = "jitter",
             facet.by = "herbicide_dose",short.panel.labs = FALSE)+
             labs(y="root_length (cm)",x="Inoculation")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif",method = "t.test", ref.group = ".all.")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "top")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
p4
ggsave("figure 1.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

#####Fresh biomass
FB<-weed_suppression%>%select("herbicide_dose","Inoculation","fresh_biomass")
compare_means(fresh_biomass~Inoculation,data = FB,method = "t.test",group.by = "herbicide_dose")

#boxplot facet by "herbicide dose"
p5<-ggboxplot(FB,x="Inoculation",y="fresh_biomass",
             add = "jitter",
             facet.by = "herbicide_dose",short.panel.labs = FALSE)+
             labs(y="fresh_biomass (g)",x="Inoculation")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif",method = "t.test", ref.group = ".all.")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "top")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
p5
ggsave("figure 1.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

######Protein
Pro<-weed_suppression%>%select("herbicide_dose","Inoculation","protein")
compare_means(protein~Inoculation,data = Pro,method = "t.test",group.by = "herbicide_dose")

#boxplot facet by "herbicide dose"
p6<-ggboxplot(Pro,x="Inoculation",y="protein",
             add = "jitter",
             facet.by = "herbicide_dose",short.panel.labs = FALSE)+
             labs(y="protein (ppm)",x="Inoculation")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif",method = "t.test", ref.group = ".all.")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "top")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
p6
ggsave("figure 1.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

#######Chlorophyll a
Chla<-weed_suppression%>%select("herbicide_dose","Inoculation","chlorophyll_a")
compare_means(chlorophyll_a~Inoculation,data = Chla,method = "t.test",group.by = "herbicide_dose")

#boxplot facet by "herbicide dose"
p7<-ggboxplot(Chla,x="Inoculation",y="chlorophyll_a",
             add = "jitter",
             facet.by = "herbicide_dose",short.panel.labs = FALSE)+
             labs(y="chlorophyll_a(ppm)",x="Inoculation")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif",method = "t.test", ref.group = ".all.")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "top")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
p7
ggsave("figure 1.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

########Chlorophyll b
Chlb<-weed_suppression%>%select("herbicide_dose","Inoculation","chlorophyll_b")
compare_means(chlorophyll_b~Inoculation,data = Chlb,method = "t.test",group.by = "herbicide_dose")

#boxplot facet by "herbicide dose"
p8<-ggboxplot(Chlb,x="Inoculation",y="chlorophyll_b",
             add = "jitter",
             facet.by = "herbicide_dose",short.panel.labs = FALSE)+
             labs(y="chlorophyll_b (ppm)",x="Inoculation")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif",method = "t.test", ref.group = ".all.")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "top")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
p8
ggsave("figure 1.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

#########Croteniod
crot<-weed_suppression%>%select("herbicide_dose","Inoculation","caroteniod")
compare_means(caroteniod~Inoculation,data = crot,method = "t.test",group.by = "herbicide_dose")

#boxplot facet by "herbicide dose"
p9<-ggboxplot(crot,x="Inoculation",y="caroteniod",
             add = "jitter",
             facet.by = "herbicide_dose",short.panel.labs = FALSE)+
             labs(y="caroteniod (ppm)",x="Inoculation")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif",method = "t.test", ref.group = ".all.")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "top")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
p9
ggsave("figure 1.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

```

# Figure 2: application of Inoculation for testing either strains combinations have ability to enhance the growth of wheat or not {#fig-2}

```{r}
cols <- setdiff(names(wheat_promotion), 'Inoculations')
y_labels <- c("seed_germination (%)","plant_height (cm)", "Root_length (cm)","fresh_biomass (g)","SPAD_value","chlorophyll_a (ppm)","chlorophyll_b (ppm)","carotenoid (ppm)","protein (ppm)")
compare_means(seed_germination~Inoculations,data = wheat_promotion,ref.group="control",
              method = "t.test")
compare_means(plant_height~Inoculations,data = wheat_promotion,method = "anova")
compare_means(Root_length~Inoculations,data = wheat_promotion,ref.group="control",
              method = "t.test")
compare_means(fresh_biomass~Inoculations,data = wheat_promotion,method = "anova")
compare_means(SPAD_value~Inoculations,data = wheat_promotion,ref.group="control",
              method = "t.test")
compare_means(chlorophyll_a~Inoculations,data = wheat_promotion,ref.group="control",
              method = "t.test")
compare_means(chlorophyll_b~Inoculations,data = wheat_promotion,ref.group="control",
              method = "t.test")
compare_means(carotenoid~Inoculations,data = wheat_promotion,ref.group="control",
              method = "t.test")
compare_means(protein~Inoculations,data = wheat_promotion,ref.group="control",
              method = "t.test")

Map(function(x, y) {
  ggboxplot(data = wheat_promotion, x = "Inoculations", y = x,
            ylab = y, xlab = "Inoculations",
            add = "jitter")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif", method = "t.test",
                     ref.group = "control")+
    rotate_x_text(angle = 40)+
    theme(legend.position = "right")+
    theme(legend.title = element_text(color="black",size = 10,
                                      face = "bold"))+
    theme(legend.text = element_text(color = "black",size = 8))
    
}, cols, y_labels) -> list_plots
list_plots$seed_germination
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_plots$plant_height
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_plots$Root_length
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_plots$fresh_biomass
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_plots$SPAD_value
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_plots$chlorophyll_a
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_plots$chlorophyll_b
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_plots$carotenoid
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_plots$protein
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

ggarrange(plotlist = list_plots,
          common.legend = TRUE,
          labels = c("A","B","C","D","E","F","G","H","I"))
ggsave("figure 2.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)


```


# Figure 3: weed infestation {#fig-3}

```{r}
cols <- setdiff(names(weed_infestation),'treatments')
y_labels <- c("total_weed_density m-2","no_of_native_weeds (%)", "shoot_length (cm)","SPAD_value","grain_yield (t ha-1)","straw_yield (t ha-1)","photosynthetic_rate (µmol m-2 s-1) ","transpiration_rate (µmol m-2 s-1)","stomatal_conductance (mmol m-2 s-1)")
compare_means(total_weed_density~treatments,data = weed_infestation,
              method = "anova")
compare_means(no_of_native_weeds~treatments,data = weed_infestation,
              method = "anova")
compare_means(shoot_length~treatments,data = weed_infestation,
              method = "anova")
compare_means(SPAD_value~treatments,data = weed_infestation,
              method = "anova")
compare_means(grain_yield~treatments,data = weed_infestation,
              method = "anova")
compare_means(straw_yield~treatments,data = weed_infestation,
              method = "anova")
compare_means(photosynthetic_rate~treatments,data = weed_infestation,
              method = "anova")
compare_means(transpiration_rate~treatments,data = weed_infestation,
              method = "anova")
compare_means(stomatal_conductance~treatments,data =weed_infestation,
              method = "anova")
Map(function(x, y) {
  ggboxplot(data = weed_infestation, x = "treatments", y = x,
            legend ="none",
            ylab = y, xlab = "treatments",
            bxp.errorbar = FALSE,
            bxp.errorbar.width = 0.4,
            notch = FALSE,
            add = "jitter")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif", method = "t.test",
                     ref.group = "weedy control")+
    scale_shape_manual(values =rep(15:18,5))+
    theme(legend.position =(0.5),
          legend.direction = "horizontal",
          legend.text = element_text(face = "italic"),
          legend.title = element_blank(),
          axis.text.x = element_text(angle = 30, hjust = 1,vjust = 1))

}, cols, y_labels) -> my_plots

my_plots$total_weed_density
ggsave("figure 3.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

my_plots$no_of_native_weeds
ggsave("figure 3.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

my_plots$shoot_length
ggsave("figure 3.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

my_plots$SPAD_value
ggsave("figure 3.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

my_plots$grain_yield
ggsave("figure 3.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

my_plots$straw_yield
ggsave("figure 3.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

my_plots$photosynthetic_rate
ggsave("figure 3.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

my_plots$transpiration_rate
ggsave("figure 3.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

my_plots$stomatal_conductance
ggsave("figure 3.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

```



# Figure 4: wheat infestation {#fig-4}

```{r}
cols <- setdiff(names(infested_wheat),'treatments')
y_labels <- c("shoot_length (cm)","SPAD_value", "no_of_tillers_plant-1","biological_yield","grain_yield (t ha-1)","straw_yield (t ha-1)","photosynthetic_rate (µmol m-2 s-1) ","transpiration_rate (µmol m-2 s-1)","stomatal_conductance (mmol m-2 s-1)")
compare_means(shoot_length~treatments,data = infested_wheat,method = "anova")
compare_means(SPAD_value~treatments,data = infested_wheat,method = "anova")
compare_means(no_of_tillers_per_plant~treatments,data = infested_wheat,method = "anova")
compare_means(biological_yield~treatments,data = infested_wheat,method = "anova")
compare_means(grain_yield~treatments,data = infested_wheat,method = "anova")
compare_means(straw_yield~treatments,data = infested_wheat,method = "anova")
compare_means(photosynthetic_rate~treatments,data = infested_wheat,method = "anova")
compare_means(transpiration_rate~treatments,data = infested_wheat,method = "anova")
compare_means(stomatal_conductance~treatments,data = infested_wheat,method = "anova")
Map(function(x, y) {
  ggboxplot(data = infested_wheat, x = "treatments", y = x,
            legend ="none",
            ylab = y, xlab = "treatments",
            bxp.errorbar = FALSE,
            bxp.errorbar.width = 0.4,
            notch = FALSE,
            add = "jitter")+
    stat_compare_means(method = "anova")+
    stat_compare_means(label = "p.signif", method = "t.test",
                     ref.group = "weed free control")+
    scale_shape_manual(values =rep(15:18,5))+
    theme(legend.position =(0.5),
          legend.direction = "horizontal",
          legend.text = element_text(face = "italic"),
          legend.title = element_blank(),
          axis.text.x = element_text(angle = 30, hjust = 1,vjust = 1))

}, cols, y_labels) -> list_of_plots

list_of_plots$shoot_length
ggsave("figure 4.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_of_plots$SPAD_value
ggsave("figure 4.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_of_plots$no_of_tillers_per_plant
ggsave("figure 4.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_of_plots$biological_yield
ggsave("figure 4.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_of_plots$grain_yield
ggsave("figure 4.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_of_plots$straw_yield
ggsave("figure 4.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_of_plots$photosynthetic_rate
ggsave("figure 4.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_of_plots$transpiration_rate
ggsave("figure 4.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

list_of_plots$stomatal_conductance
ggsave("figure 4.tiff",path = "figures")
export::graph2ppt(file="figures.ppt",append=TRUE)

```


